## Hostblock config

[Global]
## Log level (ERROR/WARNING/DEBUG)
## ERROR - write only error messages to syslog
## WARNING - write error and warning messages to syslog
## INFO - write error, warning and info messages to syslog (default)
## DEBUG - write all messages to syslog
log.level = INFO

## Interval for log file check (seconds, default 30)
#log.check.interval = 30

## Needed score to create iptables rule for IP address connection drop (default 10)
#address.block.score = 10

## Score for each iptables counted packet after rule is added (default 1)
## If > 0, score will increase for address with each packet received after address is blocked
#address.refused.score = 1

## Score multiplier to calculate time how long iptables rule should be kept (seconds, default 3600, 0 will not remove)
## 
## If score == 1:
## 1*3600 - hour
## 1*86400 - day
## 1*432000 - 5 days
## 1*2592000 - 30 days
## 
## If score == 4:
## 4*3600 - 4 hours
## 4*86400 - 4 days
## 4*432000 - 20 days
## 4*2592000 - 120 days
#address.block.multiplier = 3600

## Datetime format (default %Y-%m-%d %H:%M:%S)
#datetime.format = %Y-%m-%d %H:%M:%S

## Datafile location
datafile.path = /usr/local/share/hostblock/hostblock.data

## Pattern and log file configuration for OpenSSH
[Log.OpenSSH]

## Full path to log file(s)
## Gentoo/SuSE
#log.path = /var/log/messages
## RedHat/Fedora
#log.path = /var/log/secure
## Mandrake/FreeBSD/OpenBSD
log.path = /var/log/auth.log

## Patterns to match
## Use %i to specify where in pattern IP address should be looked for
## Score must follow after pattern, if not specified by default will be set 1
log.pattern = ^.+? sshd\[\d+\]: Invalid user \S+ from %i
log.score = 2
log.pattern = ^.+? sshd\[\d+\]: error: PAM: Authentication failure for \S+ from %i
log.pattern = ^.+? sshd\[\d+\]: ROOT LOGIN REFUSED FROM %i
log.score = 20
log.pattern = ^.+? sshd\[\d+\]: SSH: Server;Ltype: Authname;Remote: %i-\d+;Name: root [preauth]
log.score = 20
log.pattern = ^.+? sshd\[\d+\]: Did not receive identification string from %i
log.pattern = ^.+? sshd\[\d+\]: User \S+ from %i not allowed because not listed in AllowUsers
log.score = 2

## Pattern and log file configuration for Apache
[Log.ApacheAccess]

## Full path to log file(s)
log.path = /var/log/apache2/access.log

## Patterns to match
## Use %i to specify where in pattern IP address should be looked for
## Score must follow after pattern, if not specified by default will be set 1
log.pattern = %i .+? \/cgi/i\ .+?
log.pattern = %i .+? \/hnap1/i\ .+?# Dlink routers sometimes return SOAP document with this request (http://forums.dlink.com/index.php?topic=12061.0)
log.score = 10
log.pattern = %i .+? \/soapcaller\.bs/i\ .+?# Morpheus * Scanner
log.score = 20
log.pattern = %i .+? \/phppath/i\ .+?
log.pattern = %i .+? \/(my|web|php|db|database|ldap|phppg)admin/i\ .+?# If PHPMyAdmin is not used, these can be considered malicious
log.pattern = %i .+? \/php\-my\-admin/i\ .+?
log.pattern = %i .+? \/phpmy\-admin/i\ .+?
log.pattern = %i .+? \/joomla\/administrator/i\ .+?
log.pattern = %i .+? \/phpinfo/i\ .+?
log.pattern = %i .+? \/sqlweb/i\ .+?
log.pattern = %i .+? \/websql/i\ .+?
log.pattern = %i .+? \/mysqldumper/i\ .+?
log.pattern = %i .+? \/sqlitemanager/i\ .+?
log.pattern = %i .+? \/webdb/i\ .+?
log.pattern = %i .+? \/allow_url_include/i\ .+?
log.score = 2
log.pattern = %i .+? \/suhosin/i\ .+?
log.pattern = %i .+? \/packets\.txt/i\ .+?
log.pattern = %i .+? \/ncsi\.txt/i\ .+?
log.pattern = %i .+? \/live_view/i\ .+?
log.pattern = %i .+? \/passwd/i\ .+?
log.score = 2
log.pattern = %i .+? \/bob\-n/i\ .+?
log.pattern = %i .+? \/\.exe/i\ .+?
log.pattern = %i .+? \/bigmir\.net/i\ .+?
log.pattern = %i .+? \/w00tw00t\.at\.isc\.sans\.dfind/i\ .+?
log.pattern = %i .+? \/w00tw00t\.at\.blackhats/i\ .+?
log.pattern = %i .+? \/xampp/i\ .+?
log.pattern = %i .+? \/typo3/i\ .+?
log.pattern = %i .+? \/pma/i\ .+?
log.pattern = %i .+? \/setup\.php/i\ .+?
log.pattern = %i .+? \/cpanelsql/i\ .+?
log.pattern = %i .+? \/invoker/i\ .+?
log.pattern = %i .+? \/save_zoho\.php/i\ .+?
log.pattern = %i .+? \/zabbix/i\ .+?
log.pattern = %i .+? \/fork/i\ .+?
log.pattern = %i .+? \/savewordtemplate/i\ .+?
log.pattern = %i .+? \/mysql/i\ .+?
log.pattern = %i .+? \/console/i\ .+?
log.pattern = %i .+? \/nosuichfile/i\ .+?
log.pattern = %i .+? \/fdopen/i\ .+?
log.pattern = %i .+? \/deletedataset/i\ .+?
log.pattern = %i .+? \/axa\.php/i\ .+?
log.pattern = %i .+? \/%63%67%69%2d%62%69%6e\/%70%68%70\?%2d%64/i\ .+?# cgi-bin\/php\?-d
log.score = 2
log.pattern = %i .+? \/%2d%64\+%61%6c%6c%6f%77%5f%75%72%6c%5f%69%6e%63%6c%75%64%65%3d%6f%6e/i\ .+?# -d allow_url_include=on
log.score = 2
log.pattern = %i .+? \/webdav/i\ .+?
log.pattern = %i .+? \/wp\-login\.php/i\ .+?# If wordpress not available, can consider all these also malicious
log.pattern = %i .+? \/fdopen\(/i\ .+?
log.score = 5
log.pattern = %i .+? \/muieblackcat/i\ .+?
log.pattern = %i .+? \/admin\.php/i\ .+?
log.pattern = %i .+? \/enter\.cfm/i\ .+?
log.pattern = %i .+? \/w19218317418621031041543/i\ .+?
log.pattern = %i .+? \/webalizer/i\ .+?
log.pattern = %i .+? \/server\-status/i\ .+?
log.score = 5
log.pattern = %i .+? \/root/i\ .+?
log.score = 5
log.pattern = %i .+? \/dexter/i\ .+?
log.pattern = %i .+? \/phpmanager/i\ .+?
log.pattern = %i .+? \/install/i\ .+?
